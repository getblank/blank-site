<!DOCTYPE html>
<html class="no-js" lang="ru-RU" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport"> 
    <meta name="generator" content="Hugo 0.79.0" />

    
        <meta name="description" content="Облачная платформа для создания бэкенда с открытым исходным кодом">
    

    
        <meta name="keywords" content="BaaS, backend, cloud, iot, platform, бэкенд, облачный сервис, интернет вещей">
    

    <meta name="author" content="BLANK">


    <base href="https://getblank.github.io/site/">

    
    <title>Stores &middot; BLANK cloud platform</title>
    

    <link rel="canonical" href="https://getblank.github.io/site/doc/stores/">
    <link rel="shortcut icon" href="/site/img/favicon.ico" />
    <link href='https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900' rel='stylesheet' type='text/css'>
<link href="/site/css/app.css" media="all" rel="stylesheet"/>
<link href="/site/css/hl-github.css" rel="stylesheet">
</head>

<body lang="ru">
 <script type="text/javascript" > (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(34002915, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true, trackHash:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/34002915" style="position:absolute; left:-9999px;" alt="" /></div></noscript> 

<div id="navbar"  class="no-expand blog"  >
    <div class="container">
        <a href="#" data-menu="sidenav" class="nav-toggle menu">
            <img src="/site/img/menu.svg" alt="menu"/>
        </a>
        <div class="logo">
            <a href="index.html" class="nav-link">BLANK</a>
        </div>
        <ul class="nav collapse" id="nav">
            <li>
                <a href="/site/doc/introduction/" class="nav-link index-link active">
                    Документация
                </a>
            </li>
            <li>
                <a href="#contacts" class="nav-link index-link" data-active-until="contacts-end" data-active-after="contacts-start">
                    Контакты
                </a>
            </li>
            <li>
                <a href="https://github.com/getblank/" class="nav-link">
                    <img src="img/GitHub-Mark-Light-32px.png" style="width: 14px; height: 14px; position: relative; top: 1px" border="0">
                    GitHub
                </a>
            </li>
        </ul>
    </div>
</div>

<div id="docs">
  <div class="docs-contents">
    
    
    
      <h3>Начало работы</h3>
    
      
        <ul>
          
            <li >
              <a href="/site/doc/introduction/">Вступление</a>
            </li>
          
            <li >
              <a href="/site/doc/quickstart/">Быстрый старт</a>
            </li>
          
            <li >
              <a href="/site/doc/settings/">Конфигурация</a>
            </li>
          
        </ul>
        <hr/>
      
    
    
      <h3>Blank CLI</h3>
    
      
        <ul>
          
            <li >
              <a href="/site/doc/cli/">CLI reference</a>
            </li>
          
            <li >
              <a href="/site/doc/build/">Сборка конфигурации</a>
            </li>
          
        </ul>
        <hr/>
      
    
    
      <h3>Blank Schema</h3>
    
      
        <ul>
          
            <li >
              <a href="/site/doc/schema/">Описание</a>
            </li>
          
            <li  class="active">
              <a href="/site/doc/stores/">Stores</a>
            </li>
          
            <li >
              <a href="/site/doc/store_reference/">Store reference</a>
            </li>
          
            <li >
              <a href="/site/doc/store-displaying/">Store displaying</a>
            </li>
          
            <li >
              <a href="/site/doc/props_reference/">Props reference</a>
            </li>
          
            <li >
              <a href="/site/doc/props-modeling/">Props modeling</a>
            </li>
          
            <li >
              <a href="/site/doc/props-displaying/">Props displaying</a>
            </li>
          
            <li >
              <a href="/site/doc/access/">Access control</a>
            </li>
          
            <li >
              <a href="/site/doc/filters/">Filters</a>
            </li>
          
            <li >
              <a href="/site/doc/httphooks/">HTTP hooks</a>
            </li>
          
            <li >
              <a href="/site/doc/lifecycle_events/">Lifecycle events</a>
            </li>
          
        </ul>
        <hr/>
      
    
    
      <h3>Serverside JS API</h3>
    
      
        <ul>
          
            <li >
              <a href="doc/serverjs/">Описание</a>
            </li>
          
            <li >
              <a href="doc/actions/">Actions</a>
            </li>
          
            <li >
              <a href="doc/db">$db</a>
            </li>
          
            <li >
              <a href="doc/request/">$request</a>
            </li>
          
            <li >
              <a href="doc/email/">Email</a>
            </li>
          
            <li >
              <a href="doc/files/">Files</a>
            </li>
          
            <li >
              <a href="doc/fs/">FS</a>
            </li>
          
            <li >
              <a href="doc/i18n/">I18n</a>
            </li>
          
            <li >
              <a href="doc/queue/">Queue</a>
            </li>
          
        </ul>
        <hr/>
      
    
    
      <h3>HTTP API</h3>
    
      
        <ul>
          
            <li >
              <a href="/site/doc/httprest/">REST</a>
            </li>
          
            <li >
              <a href="/site/doc/httpauth/">Auth</a>
            </li>
          
        </ul>
        <hr/>
      
    
    
      <h3>Интеграция</h3>
    
      
        <ul>
          
            <li >
              <a href="/site/doc/facebook/">Facebook</a>
            </li>
          
        </ul>
        <hr/>
      
    

  </div>
  <div class="doc-wrapper">
    <div class="doc">
      <h1>Stores</h1>
      <div class="content">
        <p>Вся функциональность разрабатываемого с Blank Schema приложения строится вокруг одного понятия — «хранилище» или «Store».
В большинстве случаев, при проектировании приложений, достаточно создать отдельный Store для каждой сущности модели данных.
Например, для простейшего приложения учёта клиентов и их заказов можно создать два Store – <code>Clients</code> и <code>Orders</code>. Store
можно воспринимать как таблицы в MySQL или коллекции в MongoDB. В Store можно добавить обработчики жизненного цикла объектов – аналог
триггеров в SQL. Можно описать заранее определённые «действия» с данными. В SQL это были бы хранимые процедуры. Но всё-таки Store
в Blank Schema являются чем-то большим, чем таблицы в базах данных. Кроме триггеров и предопределённых действий, в Store есть:</p>
<ul>
<li>HTTP REST API для CRUD, включается одним параметром;</li>
<li>HTTP Hooks: в дополнение к стандартному CRUD REST API, можно создать описать обработчики HTTP запросов на JavaScript;</li>
<li>Tasks: задачи, выполняемые по расписанию;</li>
<li>Widgets: инструменты для отображения статистики;</li>
<li>Filters: набор заранее заданных поисковых критериев, которые будут доступны пользователю в интерфейсе и через API;</li>
<li>I18N: специфичные для этой Store локализации;</li>
<li>Настройки отображения в интерфейсе пользователя;</li>
<li>Настройки прав доступа.</li>
</ul>
<h2 id="пример-описания-store">Пример описания Store</h2>
<p>Формат конфигурации, которые передается серверу Blank – JSON. Но так как мы используем сборщик конфигурации на
Node JS, для удобства и большей гибкости в распределении кода, описания Store выполняются в виде JavaScript объекта,
экспортируемого модулем.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">module.exports <span style="color:#000;font-weight:bold">=</span> {
    <span style="color:#d14">&#34;exampleStore&#34;</span><span style="color:#000;font-weight:bold">:</span> {
        <span style="color:#d14">&#34;display&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;list&#34;</span>,
        <span style="color:#d14">&#34;navOrder&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#099">0</span>,
        <span style="color:#d14">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;{{$i18n.storeLabel}}&#34;</span>,
        <span style="color:#d14">&#34;labels&#34;</span><span style="color:#000;font-weight:bold">:</span> [],
        <span style="color:#d14">&#34;props&#34;</span><span style="color:#000;font-weight:bold">:</span> {
            <span style="color:#d14">&#34;exampleProp&#34;</span><span style="color:#000;font-weight:bold">:</span> {
                <span style="color:#d14">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;string&#34;</span>,
                <span style="color:#d14">&#34;display&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;textInput&#34;</span>,
            },
        },
        <span style="color:#d14">&#34;actions&#34;</span><span style="color:#000;font-weight:bold">:</span> [],
        <span style="color:#d14">&#34;objectLifeCycle&#34;</span><span style="color:#000;font-weight:bold">:</span> {},
        <span style="color:#d14">&#34;storeLifeCycle&#34;</span><span style="color:#000;font-weight:bold">:</span> {},
        <span style="color:#d14">&#34;filters&#34;</span><span style="color:#000;font-weight:bold">:</span> {},
        <span style="color:#d14">&#34;httpHooks&#34;</span><span style="color:#000;font-weight:bold">:</span> [],
        <span style="color:#d14">&#34;tasks&#34;</span><span style="color:#000;font-weight:bold">:</span> [],
        <span style="color:#d14">&#34;i18n&#34;</span><span style="color:#000;font-weight:bold">:</span> {
            <span style="color:#d14">&#34;storeLabel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;exampleStore&#34;</span>,
        },
    },
};
</code></pre></div><p>В JSON нет возможности писать функции, но JavaScript объекты позволяют это делать, а сборщик преобразует эти функции
в строку, затем на сервере из этих строк вновь будут созданы соответствующие функции.</p>
<p>Например, можно написать функцию для обработки действия пользователя:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#d14">&#34;actions&#34;</span><span style="color:#000;font-weight:bold">:</span> [
    {
        <span style="color:#d14">&#34;_id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;switchOnOff&#34;</span>,
        <span style="color:#d14">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;{{#if $item.disabled}}Включить{{else}}Выключить{{/if}}&#34;</span>,
        <span style="color:#d14">&#34;script&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">function</span> ($db, $item) {
            <span style="color:#000;font-weight:bold">return</span> $db.set({ <span style="color:#d14">&#34;_id&#34;</span><span style="color:#000;font-weight:bold">:</span> $item._id, disabled<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">!</span>$item.disabled }, <span style="color:#d14">&#34;accounts&#34;</span>);
        },
    },
],
</code></pre></div><p>Подробнее о действиях читайте в разделе <a href="/site/doc/actions">Actions</a>.</p>
<h2 id="особенности-работы-со-сборщиком">Особенности работы со сборщиком</h2>
<p>При использовании сборщика можно разделить конфигурацию на отдельные файлы для каждой Store. Если описание Store становится слишком
большим, его также можно разделить на отдельные файлы, создав, например, отдельную директорию для Store:</p>
<pre><code>▾ accounts/
  accountsStore.js
  _actions.js
</code></pre><p>Обратите внимание на &lsquo;_&rsquo; в начале названия файла <strong>'_actions.js'</strong> – это директива для сборщика, указывающая, что в этом файле
нет описания отдельной Store.</p>
<p>Для использования _actions теперь нужно подключиться их через require в описании Store:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#d14">&#34;actions&#34;</span><span style="color:#000;font-weight:bold">:</span> require(<span style="color:#d14">&#34;./_actions&#34;</span>);
</code></pre></div><h2 id="дальнейшее-чтение">Дальнейшее чтение</h2>
<p>Более подробную информацию о настройках Store читайте в разделе <a href="/site/doc/store_reference/">Store reference</a></p>

      </div>
    </div>
  </div>
  <div class="clear"></div>
</div>

<footer id="contacts">
  <div id="contacts-start"></div>
  <div>
    <p>2020 &copy; Blank</p>
    <p>Телефон: +7 (922) 477-26-60</p>
    <p>E-mail: info+blank@sclif.pro</p>
    <p style="font-size: .8rem">Россия &middot; Тюмень</p>
    <p class="hugo">Site powered by <a href="http://gohugo.io">Hugo</a></p>
  </div>
  <div id="contacts-end"></div>
</footer>
<div id="lightbox" class="hidden">
  <div class="back"></div>
  <div class="close"></div>
  <div class="image">
    <img src="" alt="" />
  </div>
</div>
<script type="text/javascript" src="app.bundle.js"></script>
<script src="/site/js/highlight.pack.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>
</body>

</html>